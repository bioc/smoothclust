% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/smoothclust.R
\name{smoothclust}
\alias{smoothclust}
\title{smoothclust}
\usage{
smoothclust(
  input,
  method = c("uniform", "kernel"),
  bandwidth = 0.05,
  truncate = 0.05
)
}
\arguments{
\item{input}{Input data, assumed to be provided as \code{SpatialExperiment}
object containing matrix of spatial coordinates in \code{spatialCoords}
slot and log-transformed normalized counts in assay named \code{logcounts}.}

\item{method}{Method used for smoothing. The \code{uniform} method calculates
average logcounts (unweighted) across all measurement locations within a
circle with radius \code{bandwidth} at each measurement location, which
smooths out spatial variability as well as sparsity due to sampling
variability. The \code{kernel} method calculates a weighted average using a
truncated exponential kernel applied to Euclidean distances with a length
scale parameter equal to \code{bandwidth}, which provides a more
sophisticated approach to smoothing out spatial variability but may be
affected by sparsity due to sampling variability, especially at the index
point.}

\item{bandwidth}{Parameter defining the bandwidth for smoothing, expressed as
the proportion of the width or height (whichever is greater) of the tissue
area. Smoothing is performed across neighboring values of logcounts at each
point. For \code{method = "uniform"}, the bandwidth represents the radius
of a circle, and unweighted average logcounts are calculated across points
within this circle. For \code{method = "kernel"}, the averaging is weighted
by distances scaled using a truncated exponential kernel applied to
Euclidean distances. For example, a bandwidth of 0.05 will smooth logcounts
across neighbors weighted by distances scaled using a truncated exponential
kernel with length scale equal to 5% of the width or height (whichever is
greater) of the tissue area. Weights for \code{method = "kernel"} are
truncated for computational efficiency.}

\item{truncate}{Truncation threshold parameter if \code{method = "kernel"}.
Kernel weights below this value are set to zero for computational
efficiency. Ignored if \code{method == "uniform"}.}
}
\value{
Returns the \code{SpatialExperiment} object with a new assay named
  \code{logcounts_smooth} containing spatially smoothed logcounts values.
}
\description{
Function to run 'smoothclust' spatial clustering algorithm.
}
\details{
Function to run 'smoothclust' spatial clustering algorithm.
}
\examples{
library(SpatialExperiment)
library(STexampleData)
library(scran)

# download data object
spe <- Visium_humanDLPFC()
spe <- spe[, colData(spe)$in_tissue == 1]

# calculate highly variable genes (HVGs)
spe <- logNormCounts(spe)
is_mito <- grepl("(^MT-)|(^mt-)", rowData(spe)$gene_name)
spe <- spe[!is_mito, ]
# keep full object for plotting
spe_full <- spe

dec <- modelGeneVar(spe)
top_hvgs <- getTopHVGs(dec, prop = 0.1)
spe <- spe[top_hvgs, ]
dim(spe)

# run smoothclust
spe <- smoothclust(spe)

}

% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/smoothclust.R
\name{smoothclust}
\alias{smoothclust}
\title{smoothclust}
\usage{
smoothclust(
  input,
  method = c("uniform", "kernel"),
  assay_name = "counts",
  bandwidth = 0.05,
  truncate = 0.05,
  assay_name_smooth = "counts_smooth"
)
}
\arguments{
\item{input}{Input data, assumed to be provided as \code{SpatialExperiment}
object containing spatial coordinates in \code{spatialCoords} slot and
expression counts in \code{assays} slots.}

\item{method}{Method used for smoothing. The \code{uniform} method calculates
unweighted averages across spatial locations within a circular window with
radius \code{bandwidth} at each spatial location, which smooths out spatial
variability as well as sparsity due to sampling variability. The
\code{kernel} method calculates a weighted average using a truncated
exponential kernel applied to Euclidean distances with a length scale
parameter equal to \code{bandwidth}, which provides a more sophisticated
approach to smoothing out spatial variability but may be affected by
sparsity due to sampling variability (especially sparsity at the index
point), and is computationally slower. Default = \code{uniform}.}

\item{assay_name}{Name of \code{assay} in input object containing expression
count values to be smoothed. Usually this will be either \code{counts} (raw
counts) or \code{logcounts} (log-transformed normalized counts). We
recommend using raw counts (\code{counts}) if available, for easier
interpretability of the averaging. Alternatively, logcounts
(\code{logcounts}) may also be used, in which case the smoothed values
represent geometric averages. Default = \code{counts}.}

\item{bandwidth}{Bandwidth parameter for smoothing, expressed as proportion
of width or height (whichever is greater) of tissue area. Smoothing is
performed across neighboring values at each point. For \code{method =
"uniform"}, the bandwidth represents the radius of a circle, and unweighted
averages are calculated across points within this circle. For \code{method
= "kernel"}, the averaging is weighted by distances scaled using a
truncated exponential kernel applied to Euclidean distances. For example, a
bandwidth of 0.05 will smooth values across neighbors weighted by distances
scaled using a truncated exponential kernel with length scale equal to 5%
of the width or height (whichever is greater) of the tissue area. Weights
for \code{method = "kernel"} are truncated at small values for
computational efficiency. Default = 0.05.}

\item{truncate}{Truncation threshold parameter if \code{method = "kernel"}.
Kernel weights below this value are set to zero for computational
efficiency. Only used for \code{method = "kernel"}. Default = 0.05.}

\item{assay_name_smooth}{Name of assay to store smoothed values. Default =
\code{"counts_smooth"}. Alternatively, set to \code{"logcounts_smooth"} if
logcounts were provided instead of raw counts for the input values.}
}
\value{
Returns the \code{SpatialExperiment} object with a new assay (default
  name \code{"counts_smooth"}) containing spatially smoothed expression
  values, which can be used as the input for further downstream analyses such
  as clustering.
}
\description{
Spatial clustering algorithm for spatial transcriptomics data.
}
\details{
Spatial clustering algorithm for spatial transcriptomics data based on the
principle of smoothing expression measurements across neighboring spatial
locations. The algorithm can be used to define spatial domains consisting of
a single cell type or a consistent mixture of cell types with smooth spatial
boundaries.
}
\examples{
library(STexampleData)

# load data
spe <- Visium_humanDLPFC()

# keep spots over tissue
spe <- spe[, colData(spe)$in_tissue == 1]

# run smoothclust
spe <- smoothclust(spe)

# check
assayNames(spe)

# see vignette for extended example including downstream analyses

}
